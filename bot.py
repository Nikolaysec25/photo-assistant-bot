import logging
import asyncio
from aiogram import Bot, Dispatcher, types
from aiogram.filters import Command
from aiohttp import web
import os

# ===============================
# üîπ –ù–∞—Å—Ç—Ä–æ–π–∫–∏
# ===============================
logging.basicConfig(level=logging.INFO)
BOT_TOKEN = os.getenv("BOT_TOKEN")

bot = Bot(token=BOT_TOKEN)
dp = Dispatcher()

# ===============================
# üîπ –°–ª–æ–≤–∞—Ä—å –∞–≤—Ç–æ–æ—Ç–≤–µ—Ç–æ–≤
# ===============================

FAQ = {
    "—Ü–µ–Ω–∞": "üì∑ –°—Ç–æ–∏–º–æ—Å—Ç—å —Ñ–æ—Ç–æ—Å–µ—Å—Å–∏–∏ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–∏–ø–∞ —Å—ä—ë–º–∫–∏. –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è ‚Äî –æ—Ç 120 BYN, —Å–µ–º–µ–π–Ω–∞—è ‚Äî –æ—Ç 150 BYN, love story ‚Äî –æ—Ç 180 BYN. –ù–∞–ø–∏—à–∏, –∫–∞–∫–æ–π —Ñ–æ—Ä–º–∞—Ç –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç?",
    "—Å—Ç–æ–∏–º–æ—Å—Ç—å": "üí∞ –ë–∞–∑–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å ‚Äî –æ—Ç 120 BYN. –í –Ω–µ—ë –≤—Ö–æ–¥–∏—Ç —Å–∞–º–∞ —Å—ä—ë–º–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ñ–æ—Ç–æ.",
    "—Ñ–æ—Ç–æ—Å–µ—Å—Å–∏—è": "üì∏ –ü—Ä–æ–≤–æ–∂—É —Ä–∞–∑–Ω—ã–µ –≤–∏–¥—ã —Ñ–æ—Ç–æ—Å–µ—Å—Å–∏–π: –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ, —Å–µ–º–µ–π–Ω—ã–µ, –¥–µ—Ç—Å–∫–∏–µ, love story, —Å—ä—ë–º–∫–∏ –¥–ª—è –±—Ä–µ–Ω–¥–æ–≤ –∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π.",
    "–≤–∏–¥—ã": "üì∑ –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è: –ø–æ—Ä—Ç—Ä–µ—Ç–Ω–∞—è, —Å–µ–º–µ–π–Ω–∞—è, love story, –∫–æ–Ω—Ç–µ–Ω—Ç-—Å—ä—ë–º–∫–∞, –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è.",
    "–º–µ—Å—Ç–æ": "üìç –°—ä—ë–º–∫–∞ –≤–æ–∑–º–æ–∂–Ω–∞ –∫–∞–∫ –≤ —Å—Ç—É–¥–∏–∏, —Ç–∞–∫ –∏ –Ω–∞ —É–ª–∏—Ü–µ. –ü–æ–º–æ–≥—É –≤—ã–±—Ä–∞—Ç—å –ª–æ–∫–∞—Ü–∏—é –ø–æ–¥ –≤–∞—à —Å—Ç–∏–ª—å.",
    "–ª–æ–∫–∞—Ü–∏—è": "üåø –°—Ç—É–¥–∏–∏ –≤ —Ü–µ–Ω—Ç—Ä–µ –≥–æ—Ä–æ–¥–∞ –∏ –∂–∏–≤–æ–ø–∏—Å–Ω—ã–µ –º–µ—Å—Ç–∞ –Ω–∞ –ø—Ä–∏—Ä–æ–¥–µ. –ú–æ–≥—É –ø–æ—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã.",
    "—Å–≤–æ–±–æ–¥–µ–Ω": "üìÖ –ß—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å —Å–≤–æ–±–æ–¥–Ω—ã–µ –¥–∞—Ç—ã, –Ω–∞–ø–∏—à–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–∏–º–µ—Ä–Ω—ã–π –¥–µ–Ω—å –∏–ª–∏ –ø–µ—Ä–∏–æ–¥ ‚Äî –ø—Ä–æ–≤–µ—Ä—é —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ.",
    "–¥–∞—Ç–∞": "üìÜ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –±—ã—Å—Ç—Ä–æ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è! –£–∫–∞–∂–∏ –¥–∞—Ç—É, –∏ —è –ø—Ä–æ–≤–µ—Ä—é, –¥–æ—Å—Ç—É–ø–µ–Ω –ª–∏ —ç—Ç–æ—Ç –¥–µ–Ω—å.",
    "–±—Ä–æ–Ω—å": "üì≤ –î–ª—è –±—Ä–æ–Ω–∏ –¥–∞—Ç—ã –Ω—É–∂–Ω–∞ –ø—Ä–µ–¥–æ–ø–ª–∞—Ç–∞ 30 BYN. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –¥–µ–Ω—å –∑–∞–∫—Ä–µ–ø–ª—è–µ—Ç—Å—è –∑–∞ –≤–∞–º–∏.",
    "—Å—Ä–æ–∫": "‚è≥ –ì–æ—Ç–æ–≤—ã–µ —Ñ–æ—Ç–æ –æ–±—ã—á–Ω–æ —á–µ—Ä–µ–∑ 7‚Äì10 –¥–Ω–µ–π –ø–æ—Å–ª–µ —Å—ä—ë–º–∫–∏.",
    "–∫–æ–≥–¥–∞": "üì∏ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ç–æ –∑–∞–Ω–∏–º–∞–µ—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–µ–¥–µ–ª—é.",
    "—Ñ–æ—Ç–æ": "üì∏ –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ñ–æ—Ä–º–∞—Ç–∞ —Å—ä—ë–º–∫–∏ –æ—Ç–¥–∞—é –æ—Ç 30 –¥–æ 60 –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ñ–æ—Ç–æ.",
    "–æ–±—Ä–∞–±–æ—Ç–∫–∞": "üñå –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, –±–µ–∑ —Å–∏–ª—å–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤. –ü–æ–¥—á—ë—Ä–∫–∏–≤–∞—é —Å–≤–µ—Ç, —Ü–≤–µ—Ç –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ.",
    "–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ": "üì∏ –û–±—ã—á–Ω–æ –æ—Ç–¥–∞—é 30‚Äì60 —Ñ–æ—Ç–æ, –Ω–æ –º–æ–∂–Ω–æ –æ–±—Å—É–¥–∏—Ç—å –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ.",
    "–∫–æ–Ω—Ç–∞–∫—Ç—ã": "üìû –°–≤—è–∑–∞—Ç—å—Å—è –º–æ–∂–Ω–æ –ø—Ä—è–º–æ –∑–¥–µ—Å—å –≤ Telegram, –ª–∏–±–æ –≤ Instagram: @photo_assistant_example",
    "–∏–Ω—Å—Ç–∞": "üì∑ Instagram: @photo_assistant_example"
}

# ===============================
# üîπ –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
# ===============================

@dp.message(Command("start"))
async def start_command(message: types.Message):
    await message.answer(
        "–ü—Ä–∏–≤–µ—Ç üëã –Ø –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∞.\n"
        "–ó–∞–¥–∞–π –ª—é–±–æ–π –≤–æ–ø—Ä–æ—Å –æ —Ñ–æ—Ç–æ—Å–µ—Å—Å–∏–∏ ‚Äî —Ä–∞—Å—Å–∫–∞–∂—É –ø—Ä–æ —Ü–µ–Ω—ã, –¥–∞—Ç—ã, –æ–±—Ä–∞–±–æ—Ç–∫—É, –∏ —Ç.–¥."
    )

# ===============================
# üîπ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç–≤–µ—Ç—ã
# ===============================

@dp.message()
async def handle_message(message: types.Message):
    text = message.text.lower()
    for key, answer in FAQ.items():
        if key in text:
            await message.answer(answer)
            return
    # –µ—Å–ª–∏ –Ω–µ –Ω–∞—à—ë–ª –ø–æ–¥—Ö–æ–¥—è—â–∏–π –æ—Ç–≤–µ—Ç
    await message.answer("–°–ø–∞—Å–∏–±–æ –∑–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ üåø –§–æ—Ç–æ–≥—Ä–∞—Ñ —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ —á—É—Ç—å –ø–æ–∑–∂–µ. –ê –ø–æ–∫–∞ –º–æ–∂–µ—Ç–µ —É—Ç–æ—á–Ω–∏—Ç—å: –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç —Ñ–æ—Ç–æ—Å–µ—Å—Å–∏—è, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–ª–∏ —Å–≤–æ–±–æ–¥–Ω—ã–µ –¥–∞—Ç—ã?")

# ===============================
# üîπ –§–∏–∫—Å –¥–ª—è Render (–ø–æ—Ä—Ç)
# ===============================

async def handle(request):
    return web.Response(text="Bot is running!")

async def web_server():
    app = web.Application()
    app.add_routes([web.get("/", handle)])
    runner = web.AppRunner(app)
    await runner.setup()
    site = web.TCPSite(runner, "0.0.0.0", 10000)
    await site.start()

async def main():
    bot_task = asyncio.create_task(dp.start_polling(bot))
    web_task = asyncio.create_task(web_server())
    await asyncio.gather(bot_task, web_task)

if __name__ == "__main__":
    logging.info("üöÄ –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ —Å –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–º...")
    asyncio.run(main())
